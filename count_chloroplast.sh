perl -MFile::Basename -ne 'BEGIN{$bf=basename($ARGV[0])}chomp; @t=split /\t/, $_; $h{$t[0]}=1; $g{$t[0]}=1 if /chloroplast/i; $m{$t[0]} =1 if /mitochondrion/i; $phi{$t[0]}=1 if /phiX/; END{$cg = scalar keys %g; $ch=scalar keys %h; $cm=scalar keys %m; $cp=scalar keys %phi;print join("\t", qw(Sample chloroplast mitochondrion phiX Total)), "\n";  print join("\t", $bf, $cg, $cm, $cp, $ch), "\n"}' $1
